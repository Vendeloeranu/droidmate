// Copyright (c) 2012-2016 Saarland University
// All rights reserved.
//
// Author: Konrad Jamrozik, jamrozik@st.cs.uni-saarland.de
//
// This file is part of the "DroidMate" project.
//
// www.droidmate.org

project.group = "org.droidmate"
project.version = "dev"

/* java plugin uses "build" for outputs by default, but the underlying ant script uses "bin".
   This is setup in root project, not in the target project, as this way we guarantee the property
   is set before it is read by any of the projects.
*/
project(":projects:uiautomator-daemon").buildDir = "bin"

ext.kotlin_version = '1.0.1-2'

ext.buildSrcJars = fileTree("$rootDir/buildSrc/build/libs") { include("*.jar") exclude("*javadoc.jar", "*sources.jar")}

buildscript {

  ext.utilities_version = 'c52a5ef326'

  repositories {
    mavenLocal()
    mavenCentral()
    maven { url "https://jitpack.io" }
  }

  dependencies {
    classpath "com.github.konrad-jamrozik:utilities:$utilities_version"
  }
}

subprojects {

  repositories {
    mavenLocal()
    mavenCentral()
    maven {url "https://jitpack.io"}
  }

  it.afterEvaluate {
    tasks.withType(Test) {

      /* N00b Reference:
        http://mrhaki.blogspot.de/2013/05/gradle-goodness-running-single-test.html
        http://www.gradle.org/docs/current/dsl/org.gradle.api.tasks.testing.logging.TestLoggingContainer.html
      */
      testLogging {
        events 'failed'
      }

      afterSuite {TestDescriptor td, TestResult tr ->

        if (td.name.contains("Test Run") && tr.successfulTestCount == tr.testCount)
          println "==> All ${tr.successfulTestCount} tests passed."
      }
    }
  }
}